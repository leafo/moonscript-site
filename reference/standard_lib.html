<!DOCTYPE HTML>
<html lang="en">
<head>
  <!-- Autogenerated from  on Fri Feb 27 00:42:26 2026 -->
  <meta charset="UTF-8">
  <title>Standard Library - MoonScript 0.5.0</title>
  <link rel="stylesheet" href="../reference.css?Fri Feb 27 00:42:26 2026" />
  <script type="text/javascript">
  if (window.location.hostname != "localhost") {
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-136625-5']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  }
</script>
</head>
<body>
  <div class="header">
    <h1>MoonScript 0.5.0 - Standard Library</h1>
  </div>

  <div class="index">
    <div class="column">
      <h3>On This Page</h3>
      <div class="index-list">
        <ul><li><a href="#moonscript-standard-library">MoonScript Standard Library</a></li>
<ul><li><a href="#moonscript-standard-library/printing-functions">Printing Functions</a></li>
<ul><li><a href="#moonscript-standard-library/printing-functions/parg"><code>p(arg)</code></a></li></ul>
<li><a href="#moonscript-standard-library/table-functions">Table Functions</a></li>
<ul><li><a href="#moonscript-standard-library/table-functions/run-with-scopefn-scope-args"><code>run_with_scope(fn, scope, [args...])</code></a></li>
<li><a href="#moonscript-standard-library/table-functions/defaultbltbl-fn"><code>defaultbl([tbl,] fn)</code></a></li>
<li><a href="#moonscript-standard-library/table-functions/extendarg1-arg2-rest"><code>extend(arg1, arg2, [rest...])</code></a></li>
<li><a href="#moonscript-standard-library/table-functions/copytbl"><code>copy(tbl)</code></a></li></ul>
<li><a href="#moonscript-standard-library/classobject-functions">Class/Object Functions</a></li>
<ul><li><a href="#moonscript-standard-library/classobject-functions/is-objectvalue"><code>is_object(value)</code></a></li>
<li><a href="#moonscript-standard-library/classobject-functions/is-classvalue"><code>is_class(value)</code></a></li>
<li><a href="#moonscript-standard-library/classobject-functions/is-instancevalue"><code>is_instance(value)</code></a></li>
<li><a href="#moonscript-standard-library/classobject-functions/is-instance-ofvalue-class"><code>is_instance_of(value, class)</code></a></li>
<li><a href="#moonscript-standard-library/classobject-functions/is-subclass-ofcls-parent"><code>is_subclass_of(cls, parent)</code></a></li>
<li><a href="#moonscript-standard-library/classobject-functions/typevalue"><code>type(value)</code></a></li>
<li><a href="#moonscript-standard-library/classobject-functions/bind-methodsobj"><code>bind_methods(obj)</code></a></li>
<li><a href="#moonscript-standard-library/classobject-functions/mixinobj-class-args"><code>mixin(obj, class, [args...])</code></a></li>
<li><a href="#moonscript-standard-library/classobject-functions/mixin-objectobj-other-obj-method-names"><code>mixin_object(obj, other_obj, method_names)</code></a></li>
<li><a href="#moonscript-standard-library/classobject-functions/mixin-tablea-b-names"><code>mixin_table(a, b, [names])</code></a></li></ul>
<li><a href="#moonscript-standard-library/misc-functions">Misc Functions</a></li>
<ul><li><a href="#moonscript-standard-library/misc-functions/folditems-fn"><code>fold(items, fn)</code></a></li></ul>
<li><a href="#moonscript-standard-library/debug-functions">Debug Functions</a></li>
<ul><li><a href="#moonscript-standard-library/debug-functions/debugupvaluefn-key-value"><code>debug.upvalue(fn, key[, value])</code></a></li></ul></ul></ul>
      </div>
    </div>

    <div class="column">
      <h3>All Pages</h3>
      <div class="index-list">
        <ul>
          <li><a href="../reference">Language Guide</a></li>
          <li><a href="../reference/standard_lib.html" class="current">Standard Library</a></li>
          <li><a href="../reference/command_line.html">Command Line Tools</a></li>
          <li><a href="../reference/api.html">Compiler API</a></li>
        </ul>
      </div>
    </div>
  </div>

  <div class="main">
    <p>The MoonScript installation comes with a small kernel of functions that can be
used to perform various common things.</p>

<p>The entire library is currently contained in a single object. We can bring this
<code>moon</code> object into scope by requiring <code>"moon"</code>.</p>

<pre><code class="moon_code"><span></span><span class="n">moon</span> <span class="o">=</span> <span class="nb">require</span> <span class="s2">&quot;</span><span class="s">moon</span><span class="s2">&quot;</span>
<span class="c1">-- `moon.p` is the debug printer</span>
<span class="n">moon</span><span class="o">.</span><span class="n">p</span> <span class="kt">{</span> <span class="nv">hello:</span> <span class="s2">&quot;</span><span class="s">world</span><span class="s2">&quot;</span> <span class="kt">}</span></code>
</pre>


<p>If you prefer to just inject all of the functions into the current scope, you
can require <code>"moon.all"</code> instead. The following has the same effect as above:</p>

<pre><code class="moon_code"><span></span><span class="nb">require</span> <span class="s2">&quot;</span><span class="s">moon.all</span><span class="s2">&quot;</span>
<span class="n">p</span> <span class="kt">{</span> <span class="nv">hello:</span> <span class="s2">&quot;</span><span class="s">world</span><span class="s2">&quot;</span> <span class="kt">}</span></code>
</pre>


<p>All of the functions are compatible with Lua in addition to MoonScript, but
some of them only make sense in the context of MoonScript.</p>

<h1 id="moonscript-standard-library">MoonScript Standard Library</h1>

<p>This is an overview of all the included functions.
All of the examples assume that the standard library has been included with
<code>require "moon.all"</code>.</p>

<h2 id="moonscript-standard-library/printing-functions">Printing Functions</h2>

<h3 id="moonscript-standard-library/printing-functions/parg"><code>p(arg)</code></h3>

<p>Prints a formatted version of an object. Excellent for inspecting the contents
of a table.</p>

<h2 id="moonscript-standard-library/table-functions">Table Functions</h2>

<h3 id="moonscript-standard-library/table-functions/run-with-scopefn-scope-args"><code>run_with_scope(fn, scope, [args...])</code></h3>

<p>Mutates the environment of function <code>fn</code> and runs the function with any extra
arguments in <code>args...</code>. Returns the result of the function.</p>

<p>The environment of the function is set to a new table whose metatable will use
<code>scope</code> to look up values. <code>scope</code> must be a table. If <code>scope</code> does not have an
entry for a value, it will fall back on the original environment.</p>

<pre><code class="moon_code"><span></span><span class="n">my_env</span> <span class="o">=</span> <span class="kt">{</span>
  <span class="nv">secret_function:</span> <span class="nf">-&gt;</span> <span class="nb">print</span> <span class="s2">&quot;</span><span class="s">shhh this is secret</span><span class="s2">&quot;</span>
  <span class="nv">say_hi:</span> <span class="nf">-&gt;</span> <span class="nb">print</span> <span class="s2">&quot;</span><span class="s">hi there!</span><span class="s2">&quot;</span>
<span class="kt">}</span>

<span class="n">say_hi</span> <span class="o">=</span> <span class="nf">-&gt;</span> <span class="nb">print</span> <span class="s2">&quot;</span><span class="s">I am a closure</span><span class="s2">&quot;</span>

<span class="n">fn</span> <span class="o">=</span> <span class="nf">-&gt;</span>
  <span class="n">secret_function</span><span class="o">!</span>
  <span class="n">say_hi</span><span class="o">!</span>

<span class="n">run_with_scope</span> <span class="n">fn</span><span class="p">,</span> <span class="n">my_env</span></code>
</pre>


<p>Note that any closure values will always take precedence against global name
lookups in the environment. In the example above, the <code>say_hi</code> in the
environment has been shadowed by the local variable <code>say_hi</code>.</p>

<h3 id="moonscript-standard-library/table-functions/defaultbltbl-fn"><code>defaultbl([tbl,] fn)</code></h3>

<p>Sets the <code>__index</code> of table <code>tbl</code> to use the function <code>fn</code> to generate table
values when a missing key is looked up.</p>

<h3 id="moonscript-standard-library/table-functions/extendarg1-arg2-rest"><code>extend(arg1, arg2, [rest...])</code></h3>

<p>Chains together a series of tables by their metatable&rsquo;s <code>__index</code> property.
Overwrites the metatable of all objects except for the last with a new table
whose <code>__index</code> is set to the next table.</p>

<p>Returns the first argument.</p>

<pre><code class="moon_code"><span></span><span class="n">a</span> <span class="o">=</span> <span class="kt">{</span> <span class="nv">hello:</span> <span class="s2">&quot;</span><span class="s">world</span><span class="s2">&quot;</span> <span class="kt">}</span>
<span class="n">b</span> <span class="o">=</span> <span class="kt">{</span> <span class="nv">okay:</span> <span class="s2">&quot;</span><span class="s">sure</span><span class="s2">&quot;</span> <span class="kt">}</span>

<span class="n">extend</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span>

<span class="nb">print</span> <span class="n">a</span><span class="o">.</span><span class="n">okay</span></code>
</pre>


<h3 id="moonscript-standard-library/table-functions/copytbl"><code>copy(tbl)</code></h3>

<p>Creates a shallow copy of a table, equivalent to:</p>

<pre><code class="moon_code"><span></span><span class="n">copy</span> <span class="o">=</span> <span class="kt">(</span><span class="n">arg</span><span class="kt">)</span> <span class="nf">-&gt;</span> <span class="kt">{</span><span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="k">in</span> <span class="nb">pairs</span> <span class="bp">self</span><span class="kt">}</span></code>
</pre>


<h2 id="moonscript-standard-library/classobject-functions">Class/Object Functions</h2>

<h3 id="moonscript-standard-library/classobject-functions/is-objectvalue"><code>is_object(value)</code></h3>

<p><strong>Deprecated:</strong> Use <code>is_instance</code> or <code>is_class</code> instead. <code>is_object</code> returns
truthy for instances, classes, and <code>__base</code> tables â€” any table with <code>__class</code>
accessible. It cannot distinguish between these cases.</p>

<h3 id="moonscript-standard-library/classobject-functions/is-classvalue"><code>is_class(value)</code></h3>

<p>Returns <code>true</code> if <code>value</code> is a MoonScript class table, <code>false</code> otherwise.
Returns <code>false</code> for instances, <code>__base</code> tables, plain tables, and non-table
values.</p>

<p>Works by checking that the value is a table with a <code>__base</code> field set directly
on it, and that its metatable has a <code>__call</code> field (the constructor). Both are
properties unique to MoonScript class tables.</p>

<pre><code class="moon_code"><span></span><span class="k">class</span> <span class="nc">MyClass</span>

<span class="n">is_class</span> <span class="nc">MyClass</span>        <span class="c1">-- true</span>
<span class="n">is_class</span> <span class="nc">MyClass</span><span class="o">!</span>       <span class="c1">-- false</span>
<span class="n">is_class</span> <span class="nc">MyClass</span><span class="o">.</span><span class="n">__base</span> <span class="c1">-- false</span></code>
</pre>


<h3 id="moonscript-standard-library/classobject-functions/is-instancevalue"><code>is_instance(value)</code></h3>

<p>Returns <code>true</code> if <code>value</code> is an instance of a MoonScript class, <code>false</code>
otherwise. Returns <code>false</code> for class tables, <code>__base</code> tables, plain tables, and
non-table values.</p>

<p>Works by checking that the value is a table whose metatable is a <code>__base</code> table
(identified by having a self-referencing <code>__index</code>), and that the value itself
is not a <code>__base</code> table.</p>

<pre><code class="moon_code"><span></span><span class="k">class</span> <span class="nc">MyClass</span>

<span class="n">is_instance</span> <span class="nc">MyClass</span><span class="o">!</span>       <span class="c1">-- true</span>
<span class="n">is_instance</span> <span class="nc">MyClass</span>        <span class="c1">-- false</span>
<span class="n">is_instance</span> <span class="nc">MyClass</span><span class="o">.</span><span class="n">__base</span> <span class="c1">-- false</span></code>
</pre>


<h3 id="moonscript-standard-library/classobject-functions/is-instance-ofvalue-class"><code>is_instance_of(value, class)</code></h3>

<p>Returns <code>true</code> if <code>value</code> is an instance of <code>class</code> or any of its parent
classes, <code>false</code> otherwise. Throws an error if <code>value</code> is not a MoonScript
instance. First verifies that <code>value</code> is a valid instance using <code>is_instance</code>,
then walks the <code>__parent</code> chain to check if the instance&rsquo;s class matches or
inherits from <code>class</code>.</p>

<pre><code class="moon_code"><span></span><span class="k">class</span> <span class="nc">Parent</span>
<span class="k">class</span> <span class="nc">Child</span> <span class="k">extends</span> <span class="nc">Parent</span>

<span class="n">is_instance_of</span> <span class="nc">Child</span><span class="o">!</span><span class="p">,</span> <span class="nc">Child</span>  <span class="c1">-- true</span>
<span class="n">is_instance_of</span> <span class="nc">Child</span><span class="o">!</span><span class="p">,</span> <span class="nc">Parent</span> <span class="c1">-- true (checks parent classes)</span>
<span class="n">is_instance_of</span> <span class="nc">Parent</span><span class="o">!</span><span class="p">,</span> <span class="nc">Child</span> <span class="c1">-- false</span></code>
</pre>


<p>To check if a value is a direct instance of a specific class without considering
inheritance, use <code>type(value) == MyClass</code> instead.</p>

<h3 id="moonscript-standard-library/classobject-functions/is-subclass-ofcls-parent"><code>is_subclass_of(cls, parent)</code></h3>

<p>Returns <code>true</code> if <code>cls</code> is a subclass of <code>parent</code>, <code>false</code> otherwise. Throws an
error if <code>cls</code> is not a MoonScript class. Note that a class is not considered a
subclass of itself. Walks the <code>__parent</code> chain starting from <code>cls</code> to check if
any ancestor matches <code>parent</code>.</p>

<pre><code class="moon_code"><span></span><span class="k">class</span> <span class="nc">Parent</span>
<span class="k">class</span> <span class="nc">Child</span> <span class="k">extends</span> <span class="nc">Parent</span>

<span class="n">is_subclass_of</span> <span class="nc">Child</span><span class="p">,</span> <span class="nc">Parent</span> <span class="c1">-- true</span>
<span class="n">is_subclass_of</span> <span class="nc">Parent</span><span class="p">,</span> <span class="nc">Child</span> <span class="c1">-- false</span>
<span class="n">is_subclass_of</span> <span class="nc">Child</span><span class="p">,</span> <span class="nc">Child</span>  <span class="c1">-- false</span></code>
</pre>


<h3 id="moonscript-standard-library/classobject-functions/typevalue"><code>type(value)</code></h3>

<p>Returns a class-aware type for a value. If <code>value</code> is an instance of a
MoonScript class, returns its class object. If <code>value</code> is a class table, returns
the string <code>"class"</code>. Returns the result of calling Lua&rsquo;s built-in <code>type</code> for
all other values, including <code>__base</code> tables and plain tables.</p>

<pre><code class="moon_code"><span></span><span class="k">class</span> <span class="nc">MyClass</span>

<span class="n">x</span> <span class="o">=</span> <span class="nc">MyClass</span><span class="o">!</span>
<span class="nb">assert</span> <span class="nb">type</span><span class="kt">(</span><span class="n">x</span><span class="kt">)</span> <span class="o">==</span> <span class="nc">MyClass</span>
<span class="nb">assert</span> <span class="nb">type</span><span class="kt">(</span><span class="nc">MyClass</span><span class="kt">)</span> <span class="o">==</span> <span class="s2">&quot;</span><span class="s">class</span><span class="s2">&quot;</span>
<span class="nb">assert</span> <span class="nb">type</span><span class="kt">(</span><span class="nc">MyClass</span><span class="o">.</span><span class="n">__base</span><span class="kt">)</span> <span class="o">==</span> <span class="s2">&quot;</span><span class="s">table</span><span class="s2">&quot;</span></code>
</pre>


<h3 id="moonscript-standard-library/classobject-functions/bind-methodsobj"><code>bind_methods(obj)</code></h3>

<p>Takes an instance of an object, returns a proxy to the object whose methods can
be called without providing self as the first argument.</p>

<pre><code class="moon_code"><span></span><span class="n">obj</span> <span class="o">=</span> <span class="nc">SomeClass</span><span class="o">!</span>

<span class="n">bound_obj</span> <span class="o">=</span> <span class="n">bind_methods</span> <span class="n">obj</span>

<span class="c1">-- following have the same effect</span>
<span class="n">obj</span><span class="o">\</span><span class="n">hello</span><span class="o">!</span>
<span class="n">bound_obj</span><span class="o">.</span><span class="n">hello</span><span class="o">!</span></code>
</pre>


<p>It lazily creates and stores in the proxy table the bound methods when they
are first called.</p>

<h3 id="moonscript-standard-library/classobject-functions/mixinobj-class-args"><code>mixin(obj, class, [args...])</code></h3>

<p>Copies the methods of a class <code>cls</code> into the table <code>obj</code>, then calls the
constructor of the class with the <code>obj</code> as the receiver.</p>

<p>In this example we add the functionality of <code>First</code> to an instance of <code>Second</code>
without ever instancing <code>First</code>.</p>

<pre><code class="moon_code"><span></span><span class="k">class</span> <span class="nc">First</span>
  <span class="nv">new:</span> <span class="kt">(</span><span class="vc">@var</span><span class="kt">)</span> <span class="nf">=&gt;</span>
  <span class="nv">show_var:</span> <span class="nf">=&gt;</span> <span class="nb">print</span> <span class="s2">&quot;</span><span class="s">var is:</span><span class="s2">&quot;</span><span class="p">,</span> <span class="vc">@var</span>

<span class="k">class</span> <span class="nc">Second</span>
  <span class="nv">new:</span> <span class="nf">=&gt;</span>
    <span class="n">mixin</span> <span class="bp">self</span><span class="p">,</span> <span class="nc">First</span><span class="p">,</span> <span class="s2">&quot;</span><span class="s">hi</span><span class="s2">&quot;</span>

<span class="n">a</span> <span class="o">=</span> <span class="nc">Second</span><span class="o">!</span>
<span class="n">a</span><span class="o">\</span><span class="n">show_var</span><span class="o">!</span></code>
</pre>


<p>Be weary of name collisions when mixing in other classes, names will be
overwritten.</p>

<h3 id="moonscript-standard-library/classobject-functions/mixin-objectobj-other-obj-method-names"><code>mixin_object(obj, other_obj, method_names)</code></h3>

<p>Inserts into <code>obj</code> methods from <code>other_obj</code> whose names are listed in
<code>method_names</code>. The inserted methods are bound methods that will run with
<code>other_obj</code> as the receiver.</p>

<pre><code class="moon_code"><span></span><span class="k">class</span> <span class="nc">List</span> 
  <span class="nv">add:</span> <span class="kt">(</span><span class="n">item</span><span class="kt">)</span> <span class="nf">=&gt;</span> <span class="nb">print</span> <span class="s2">&quot;</span><span class="s">adding to</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span>
  <span class="nv">remove:</span> <span class="kt">(</span><span class="n">item</span><span class="kt">)</span> <span class="nf">=&gt;</span> <span class="nb">print</span> <span class="s2">&quot;</span><span class="s">removing from</span><span class="s2">&quot;</span><span class="p">,</span> <span class="bp">self</span>

<span class="k">class</span> <span class="nc">Encapsulation</span>
  <span class="nv">new:</span> <span class="nf">=&gt;</span>
    <span class="vc">@list</span> <span class="o">=</span> <span class="nc">List</span><span class="o">!</span>
    <span class="n">mixin_object</span> <span class="bp">self</span><span class="p">,</span> <span class="vc">@list</span><span class="p">,</span> <span class="kt">{</span><span class="s2">&quot;</span><span class="s">add</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="s">remove</span><span class="s2">&quot;</span><span class="kt">}</span>

<span class="n">e</span> <span class="o">=</span> <span class="nc">Encapsulation</span><span class="o">!</span>
<span class="n">e</span><span class="o">.</span><span class="n">add</span> <span class="s2">&quot;</span><span class="s">something</span><span class="s2">&quot;</span></code>
</pre>


<h3 id="moonscript-standard-library/classobject-functions/mixin-tablea-b-names"><code>mixin_table(a, b, [names])</code></h3>

<p>Copies the elements of table <code>b</code> into table <code>a</code>. If names is provided, then
only those names are copied.</p>

<h2 id="moonscript-standard-library/misc-functions">Misc Functions</h2>

<h3 id="moonscript-standard-library/misc-functions/folditems-fn"><code>fold(items, fn)</code></h3>

<p>Calls function <code>fn</code> repeatedly with the accumulated value and the current value
by iterating over <code>items</code>. The accumulated value is the result of the last call
to <code>fn</code>, or, in the base case, the first value. The current value is the value
being iterated over starting with the second item.</p>

<p><code>items</code> is a normal array table.</p>

<p>For example, to sum all numbers in a list:</p>

<pre><code class="moon_code"><span></span><span class="n">numbers</span> <span class="o">=</span> <span class="kt">{</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="kt">}</span>
<span class="n">sum</span> <span class="o">=</span> <span class="n">fold</span> <span class="n">numbers</span><span class="p">,</span> <span class="kt">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="kt">)</span> <span class="nf">-&gt;</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span></code>
</pre>


<h2 id="moonscript-standard-library/debug-functions">Debug Functions</h2>

<h3 id="moonscript-standard-library/debug-functions/debugupvaluefn-key-value"><code>debug.upvalue(fn, key[, value])</code></h3>

<p>Gets or sets the value of an upvalue for a function by name.</p>

  </div>

  <div class="footer">Generated on Fri Feb 27 00:42:26 2026; MoonScript v0.5.0</div>
</body>
</html>
